/* ==========================================================================
   HEADER — VERSIONE USER (extra rispetto al guest)
   Dipende dalle variabili/btn già definite in header_guest.css
   ========================================================================== */

/* ==========  AREA DESTRA (pill uniformi + equidistanza)  ========== */
.site-header--user .site-header__auth{
  display:flex;
  align-items:center;
  justify-content:flex-end;
  gap:12px;                 /* distanza ESTERNA identica */
  flex-wrap:nowrap;
  line-height:1;
  position:relative;        /* nuovo contesto di stacking */
  z-index:3;                /* sopra alla nav a tendina */
}

/* Ogni figlio è una “pill” con metrica identica */
.site-header--user .site-header__auth > *{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  box-sizing:border-box;
  height:32px;
  padding:0 12px;
  border-radius:var(--radius-pill);
  font-size:13px;
  font-weight:800;
  line-height:1;
  margin:0;
}

/* Bottoni coerenti con le pill */
.site-header--user .btn{
  height:32px;
  padding:0 12px;
  font-size:13px;
  line-height:1;
  box-sizing:border-box;
}
.site-header--user .btn--primary{
  /* bordo trasparente per “misurare” come l’outline */
  border:1px solid transparent;
}

/* Crediti + refresh */
.site-header--user .user-credits{
  display:inline-flex;
  align-items:center;
  gap:6px;
  padding:0 12px;
  height:32px;
  border-radius:var(--radius-pill);
  background:rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.22);
  color:var(--text-300);
  font-size:13px;
  font-weight:800;
}
.site-header--user .user-credits__label,
.site-header--user .user-credits__value{ line-height:1; }

.site-header--user .credits-refresh{
  width:20px;height:20px;
  display:inline-flex;align-items:center;justify-content:center;
  border-radius:50%;
  border:1px solid rgba(255,255,255,.22);
  background:transparent;color:var(--text-300);
  padding:0;line-height:1;cursor:pointer;
}
.site-header--user .credits-refresh__icon{ display:block; }

/* User (avatar link + nome) */
.user-display{ display:inline-flex;align-items:center;gap:6px;color:var(--text-100); }
.user-avatar__link{
  display:inline-flex;align-items:center;text-decoration:none;color:inherit;
  cursor:pointer;pointer-events:auto;position:relative;z-index:10;
}
.user-avatar__circle{
  width:30px;height:30px;border-radius:50%;
  display:inline-flex;align-items:center;justify-content:center;
  font-weight:900;font-size:12px;line-height:1;color:var(--text-100);
  background:rgba(255,255,255,.08);
  border:1px solid rgba(255,255,255,.22);
}
.user-display__name{ font-size:13px;font-weight:800;color:var(--text-100); }

/* Logout più piccolo */
.site-header--user .logout-form{ display:inline-flex;align-items:center;margin:0;padding:0;line-height:1; }
.site-header--user .logout-form .btn{
  height:24px;             /* più basso delle altre pill */
  padding:0 8px;
  font-size:10px;
  line-height:1;
  text-transform:none;     /* “Logout” con sola L maiuscola */
  margin-top:0;
}

/* ==========  NAV MOBILE (tendina dentro l’header)  ========== */
/* Di default CHIUSA in desktop e mobile; la apriamo sotto con .menu-open */
.site-header--user .site-header__nav{
  position:absolute;top:100%;left:0;right:0;
  background:#0a0a0b;
  border-top:1px solid rgba(255,255,255,.06);
  padding:12px 16px;
  display:none;               /* chiusa di default */
  z-index:9;
  max-height:calc(100vh - var(--header-h));
  overflow:auto;
}

/* Quando il toggle apre il menu */
.site-header--user.menu-open .site-header__nav{
  display:flex;
  flex-direction:column;
}

/* La lista riempie il nav (così possiamo spingere il logout in fondo) */
.site-header--user .primary-menu{
  display:flex;flex-direction:column;align-items:flex-start;
  gap:10px;margin:0;list-style:none;
  flex:1 1 auto;min-height:0;
}
.site-header--user .primary-menu__link{
  display:inline-block;padding:8px 0;font-size:var(--fs-16);
  font-weight:700;text-transform:uppercase;letter-spacing:.03em;
  color:var(--text-300);text-decoration:none;line-height:1.2;
}
.site-header--user .primary-menu__link:hover,
.site-header--user .primary-menu__link:focus-visible{
  color:var(--text-100);outline:none;
}

/* Sezione USER in cima alla tendina */
.user-mobile{
  border-bottom:1px solid rgba(255,255,255,.08);
  padding-bottom:8px;margin-bottom:8px;
}
.user-mobile .user-avatar__link{
  display:flex;align-items:center;gap:8px;text-decoration:none;
  color:var(--text-100);font-weight:700;
}
.user-mobile .user-avatar__circle{ width:28px;height:28px;font-size:12px;line-height:1; }

/* Logout in fondo alla tendina  */
.logout-mobile{ margin-top:auto;padding-top:12px;border-top:1px solid rgba(255,255,255,.08);text-align:left; }
.logout-mobile .btn{ width:100%;justify-content:center; }

/* ===== SUB-NAV DESKTOP (fuori dall’header, sempre visibile su desktop) ===== */
.site-subnav {
  display: block !important;          /* forza visibilità su desktop */
  width: 100%;
  background: #0f1114;                /* stesso nero dell’header (oppure #0f1114 se vuoi il colore del body) */
  border-top:    0.5px solid rgba(255,255,255,0.06);
  border-bottom: 0.5px solid rgba(255,255,255,0.06);
  z-index: 2;                          /* sopra al contenuto, sotto a overlay/popup */
}
.subnav__inner {
  max-width: var(--container-w);
  margin: 0 auto;
  padding: 0 var(--pad-x);
}
.subnav-menu {
  display: flex;
  justify-content: center;             /* voci centrate */
  align-items: center;
  gap: 24px;
  list-style: none;
  margin: 0;
  padding: 0;
  height: 30px;                        /* altezza fascia */
}
.subnav-menu__link {
  display: inline-block;
  padding: 10px 0;                     /* area click verticale */
  font-size: 14px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.03em;
  color: var(--text-300);
  text-decoration: none;
  line-height: 1;
}
.subnav-menu__link:hover,
.subnav-menu__link:focus-visible {
  color: var(--text-100);
  outline: none;
}
  /* Desktop: il dropdown mobile (dentro l’header) non si vede */
.site-header__nav { display: none; }

/* ==========  MOBILE  (<980px)  ========== */
@media (max-width:980px){

  /* Top bar mobile: layout della riga */
  .site-header--user .site-header__inner{
    display:flex; 
    align-items:center; 
    justify-content:space-between;
    position:relative; 
    min-height:var(--header-h); 
    padding:0 var(--pad-x);
  }

  /* Nascondi la sub-nav fissa: in mobile usiamo la tendina */
  .site-subnav{ display:none; }

  /* Blocco sinistra: toggle + logo */
  .site-header--user .site-header__left{ 
    display:flex; 
    align-items:center; 
    gap:8px; 
    position:relative; 
  }
  /* Toggle "Menu" — stile pill identico alle altre pill mobile (USER) */
.site-header--user .site-header__toggle{
  display: inline-flex;
  align-items: center;
  justify-content: center;

  /* metrica pill = 30px x 12px, come nel resto */
  height: 30px;
  padding: 0 10px;

  /* tipografia identica */
  font-size: 12px;
  font-weight: 800;
  letter-spacing: 0.03em;
  line-height: 1;

  /* estetica outline coerente col tema */
  border-radius: var(--radius-pill);
  background-color: rgba(255,255,255,0.04);
  color: var(--text-300);
  border: 1px solid rgba(255,255,255,0.22);

  /* garantisce che iOS non rimetta stile nativo */
  -webkit-appearance: none;
  appearance: none;
}
  .site-header--user .site-header__logo .logo__img{ height:40px; }
  .site-header--user .site-header__logo .logo__text{ font-size:14px; font-weight:800; }

  /* In mobile TENIAMO in top bar solo Ricarica + Crediti.
     Nascondiamo qui User/Logout della TOP BAR (li mostriamo nella tendina). */
  .site-header--user .user-display,
  .site-header--user > .site-header__inner .logout-form{ display:none; }

  /* Pill un filo più compatte in mobile */
  .site-header--user .site-header__auth > *{ height:30px; padding:0 10px; font-size:12px; }
  .site-header--user .user-credits{ height:30px; padding:0 8px; gap:6px; font-size:12px; }
  .site-header--user .credits-refresh{ width:18px; height:18px; }
  .site-header--user .btn{ height:30px; padding:0 10px; font-size:12px; margin-top:0; }
  .site-header--user .user-avatar__circle{ width:18px; height:18px; font-size:11px; }

  /* === TENDINA MOBILE === */
  /* Chiusa di default */
  .site-header--user .site-header__nav{
    position:absolute; 
    top:100%; 
    left:0; right:0;
    transform:none;
    background:#0a0a0b;
    border-top:1px solid rgba(255,255,255,.06);
    padding:12px 16px;
    display:none;           /* CHIUSA */
    z-index:9;
    max-height:calc(100vh - var(--header-h));
    overflow:auto;
  }

  /* Aperta: il NAV diventa FLEX a colonna (serve per spingere il logout in fondo) */
  .site-header--user.menu-open .site-header__nav{
    display:flex;
    flex-direction:column;
  }

  /* La UL riempie l’altezza del nav → abilita margin-top:auto sul logout */
  .site-header--user .primary-menu{
    display:flex; 
    flex-direction:column; 
    align-items:flex-start;
    gap:10px; 
    margin:0;
    flex:1 1 auto;   /* RIEMPI il nav */
    min-height:0;    /* evita “collassi” d’altezza */
  }

  /* USER in cima (separatore) */
  .user-mobile{
    border-bottom:1px solid rgba(255,255,255,.08);
    padding-bottom:8px;
    margin-bottom:8px;
  }
  .user-mobile .user-avatar__link{
    display:flex; 
    align-items:center; 
    gap:8px;
    text-decoration:none; 
    color:var(--text-100); 
    font-weight:700;
  }
  .user-mobile .user-avatar__circle{ width:28px; height:28px; font-size:12px; line-height:1; }

  /* LOGOUT in fondo dentro la tendina */
  .logout-mobile{
    margin-top:auto;         
    padding-top:12px;
    border-top:1px solid rgba(255,255,255,.08);
    text-align:left;
  }
  .logout-mobile .logout-form{ display:inline-flex !important; } /* RIATTIVA il form nascosto */
  .logout-mobile .btn{ width:100%; justify-content:center; }
}